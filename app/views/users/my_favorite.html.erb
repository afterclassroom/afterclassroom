<% content_for :search do -%>
  <%= render :partial => 'shared/search_inbox', :locals => {:search_name => @search_name, :type_name => "Favorites", :action_path => "#{my_favorite_user_path(current_user)}"} %>
<% end -%>

<% content_for :tabs_inbox do -%>
  <%= render :partial => 'shared/tabs_inbox' %>
<% end -%>

<!--Content-->
<!-- you favorite-->
<%= your_favorite_today() %>
<!-- you favorite-->

<div id="main-listing">
  <div class="expandable-box"><!--expandable-box-->
    <% for favorite in @list_favorites %>
      <div class="exp-box-wrap"><!--exp-box-wrap-->
        <div class="exp-box1">
          <%= link_to favorite.post.title, favorite.post %>
        </div>
        <div class="exp-box2">
          <%= link_to favorite.post.user.full_name, {:controller => "profile", :action => "show_profile", :id => favorite.post.user.id} %>,
          <% if favorite.post.user.school.website %>
            <%= link_to favorite.post.user.school.name, favorite.post.user.school.website, :target => "_blank" %>
          <% else %>
            <%= favorite.post.user.school.name %>
          <% end %>
        </div>
        <div class="exp-box3">
          <%= favorite.post.created_at.strftime("%B %d, %Y") %>
        </div>
        <div class="info-link-box"><!--info-link-box-->
          <div class="details-link">
            <span rel="<%= show_post_dialog(favorite.post) %>" style="cursor:pointer">View Detail</span> | <%= link_to "Delete", "#{delete_favorite_user_path(current_user)}?favorite_id=#{favorite.id}" %>
          </div>
          <div class="download-rel-link">
            <% if favorite.favorite.post.attach_file_name %>
              <a href="javascript:downloadFile('<%= favorite.post.attach.url %>')" class="downarrow">Download</a>
            <% else %>
              <span>Download</span>
            <% end %>
            | <a href="?more_like_this_id=<%= favorite.post.id %>" title="">More like this</a>
          </div>
        </div><!--end info-link-box-->
      </div>	<!--end exp-box-wrap-->
    <% end %>
  </div>	<!--end expandable-box-->
</div>

<%= will_paginate @list_favorites, :class => "digg_pagination" %>

<script language="javascript">
  document.observe('dom:loaded', function() {
    $$('span[rel]').each(function(element) {
      show_detail_path = element.readAttribute("rel");
      new Tip(element, {
        ajax: {
          url: show_detail_path,
          options: {
            asynchronous:true,
            evalScripts:true,
            method: 'get'
          }
        },
        width: 'auto',
        title: 'Detail',
        showOn: 'click',
        hideOthers: true,
        hideOn: { element: 'closeButton', event: 'click'},
        hook: { target: 'bottomLeft', tip: 'topLeft' },
        offset: {x:0, y:5} });
    });
  });
<% if current_user %>
    var send_email_path = "/messages/send_message";
    var user_id = "<%= current_user.id %>";
    function sendEmail(post_id, to){
      subject = $("message_subject_"+post_id).value;
      body = $("message_body_"+post_id).value;
      new Ajax.Request(send_email_path,
      {asynchronous:true,
        evalScripts:true,
        method:'get',
        on500:function(request){alert('Sorry, there was an error.'.l); return false},
        parameters:{user_id:user_id, message_to:to, message_subject:subject, message_body:body},
        onSuccess:function(){
          $('send_message_alert_'+post_id).show();
          $('send_message_wraper_'+post_id).hide();
        }}
    );
    }
<% end %>
  function downloadFile(path){
    document.location.href = path;
  }
</script>
<!--Content-->
