<div class="reqLa"><label>Department</label></div>
<div class="reqTi"><%= f.text_field :department_id, :id => "department_id" %></div>
<ul id="department_menu" class="mcdropdown_menu">
  <%
  departments = Department.of_school(@school)
%>
  <li rel_department="">
    Chose department
  </li>
  <%
  category_id = ""
%>
  <% departments.each do |dp| %>
    <% if category_id == "" %>
      <li rel="category_id_<%= dp.department_category.id %>">
        <%= dp.department_category.name %>
        <ul>
          <li rel_department="<%= dp.id %>"><%= dp.name %></li>
        <% elsif category_id == dp.department_category.id %>
          <li rel_department="<%= dp.id %>"><%= dp.name %></li>
        <% else %>
        </ul>
      </li>
      <li rel="category_id_<%= dp.department_category.id %>">
        <%= dp.department_category.name %>
        <ul>
          <li rel_department="<%= dp.id %>"><%= dp.name %></li>
        <% end %>
        <% category_id = dp.department_category.id %>
      <% end %>
    </ul>
  </li>
</ul>

<script type="text/javascript">
  $("#department_id").mcDropdown("#department_menu", {
    width: 350,
    valueAttr: "rel_department"
  });
</script>
