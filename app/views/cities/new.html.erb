<% content_for :header do -%>
  <%= link_to 'Cities', cities_path %>
<% end -%>

<div id="posting-section">
  <% form_for(@city, :html => {:id => "form"}) do |f| %>
    <fieldset>
      <legend><strong>New City</strong></legend>
      <ul>
        <%= render :partial => "country_state", :locals => {:countries => @countries, :country_name => nil, :state_name => nil, :states => nil, :action_name => "new"} %>
        <li><label>City name*</label>
          <div class="user_ri">
            <%= f.text_field :name, :class => "required" %>
          </div>
        </li>
        <li>
          <div class="post_cbt">
            <!-- post  button -->
            <a href="javascript:submit()" title="Post" class="link_bt">
              <span class="ltred_l"></span>
              <span class="ltred_c btf">Create</span>
              <span class="ltred_r"></span>
            </a>
            <!-- end post button -->
          </div>
        </li>
      </ul>
      <div id="elements_store"></div>
    </fieldset>
  <% end %>
</div>

<script type="text/javascript">
  var valid = new Validation('form', {immediate : true, onSubmit:false});
  function submit(){
    var result = valid.validate();
    if (result) {
      Tips.hideAll();
      $$('.prototip').each(function(element){
        $('elements_store').insert(element, { position: content });
      });
      $('form').submit();
    }
  }
</script>