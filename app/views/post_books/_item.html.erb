<div class="assItem">
    <div class="assItemL">
        <div class="assPic">
            <%= show_image_user_post(post.user) %>
        </div>
        <div class="assContT">
            <h2 class="titleH2"><%= link_to title, post_book_path(post.post_book) %></h2>
            <div class="assCate">
                <span>From:</span>
                <%= link_to post.school.name, :controller => "post_books", :action => "index", :from_school => post.school, :book_type_id => @book_type_id %>
            </div>
            <div class="assDes">
                <div class="assImg">
                    <div>
                        <%= link_to image_post_thumb(controller_name, post), post.post_book %>
                    </div>
                </div>
                <%= truncate_html(description, :length => 250, :omission => '...') %>
            </div>
        </div>
    </div>
    <div class="assItemB">
        <div class="assInfT">
            <div class="assInfT">
                <div class="assInfL">
                    <div>
                        <span>Posted by:</span>
                        <%= show_user_post(post.user) %>
                    </div>
                </div>
            </div>
            <div class="assInfB">
                <div id="rate_<%= post.id %>">
                    <%
                    check = PostBook.find_rated_by(current_user).include?(post.post_book) if logged_in?
                    check ||= false %>
                    <div class="qashdU">
                        <%= show_rating(post.id, post.post_book.total_good, controller.controller_name, check, 1) %>
                    </div>
                    <div class="qashdD">
                        <%= show_rating(post.id, post.post_book.total_bad, controller.controller_name, check, 0) %>
                    </div>
                </div>
                <div class="vie">
                    <%= "View (#{post.count_view})" %>
                </div>
                <div class="fav" id="item_favorite_<%= post.id %>">
                    <%= show_favorite("Post", post) %>
                </div>
                <div class="com">
                    <%= show_comment_button(post.id, post.comments.size) %>
                </div>
								<div class="myMap">
                    <%= show_map(post.post_book.address, post.title) %>
                </div>
            </div>
        </div>
    </div>
    <!--Comments-->
    <%= render :partial => "shared/post_comments/show_list_comments", :locals => {:post => post} %>
    <!--Comments-->
</div>

<div visible="false" id="cmt_dialog_<%= post.id %>" style="display:none;">

<div id="desc_count<%= post.id %>">255 characters max</div>
<%= text_area_tag "rate_content", "", :id => "rate_content#{post.id}", :style => "width:568px; height: 60px;" %>

</div>

<script type="text/javascript">
function PostRateComment<%= post.id %>(){
  $.ajax({
    url: '<%= rate_cmt_post_books_url(current_user) %>',
    type: 'GET',
    dataType: 'html',
    data: 'id=123',
    success: function(html){
    }
  });
}
function ShowDialog_<%= post.id %>(strtitle){
  $('#cmt_dialog_<%= post.id %>').show();
  $("#cmt_dialog_<%= post.id %>").dialog({
    title: strtitle,
    modal: true,
    width: 600,
    height: 200,
    buttons: [
      { text: "Ok",
        click: function() {
          $(this).dialog("close");
          PostRateComment<%= post.id %>();
        }//end function click
      },//end button text
      { text: "Cancel",
        click: function() {
          $(this).dialog("close");
        }//end function click
      }//end button text
    ] //end button
  });
  //$('.ui-dialog-titlebar').hide();
  $('.ui-dialog').draggable( "destroy" );
}

$(document).ready(function(){
  $('#rate_<%= post.id %>').find('a').each(function(){
    var strLink = $(this).attr('href');
    if (strLink == 'javascript:;' ){
      $(this).parent().click(function(){
        ShowDialog_<%= post.id %>("Rating summary");
      });
    }
    else{
      $(this).parent().click(function(){
        if ($(this).attr('class') == "qashdU"){
          ShowDialog_<%= post.id %>("I like this because... ");
        }else {
          ShowDialog_<%= post.id %>("I dislike this because... ");
        }
      });
    }
  });//end .each
  //BEGIN limit input to 255 characters
    $('#rate_content<%= post.id %>').keyup(function(){
      var len = this.value.length;
      if (len >= 255) {
        this.value = this.value.substring(0, 255);
      }
      $('#desc_count<%= post.id %>').text("255 characters max - Current: "+len+" character")
    });

  //END limit input to 255 characters

});//end ready event
</script>